general:
  branches:
    ignore:
      - gh-pages
machine:
  node:
    version: 8
dependencies:
  override:
    - yarn
  pre:
    - git config --global user.email "gh-pages@localhost"
    - git config --global user.name "npm gh-pages"
test:
  override:
    - yarn lint
    - yarn flow
    - yarn test --reporter xunit:
        environment:
          MOCHA_FILE: $CIRCLE_TEST_REPORTS/junit/test-results.xml
    - yarn build
deployment:
  master:
    branch: master
    commands:
      - sh ./scripts/deploy.sh
    skip_cleanup: true
